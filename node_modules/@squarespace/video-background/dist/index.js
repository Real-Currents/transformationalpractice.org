'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});

var _videoBackgroundRendering = require('@squarespace/video-background-rendering');

var _GetVideoPropsFromNode = require('./GetVideoPropsFromNode');

var _GetVideoPropsFromNode2 = _interopRequireDefault(_GetVideoPropsFromNode);

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function VideoBackground(element, afterInitialize) {
  var rootNode = element.querySelector('.sqs-video-background');
  var props = (0, _GetVideoPropsFromNode2.default)(rootNode);
  var renderer = new _videoBackgroundRendering.VideoBackground(props);

  var handleResize = function handleResize() {
    renderer.scaleVideo();
  };

  var handleTweak = function handleTweak() {
    renderer.destroy();
    renderer = new _videoBackgroundRendering.VideoBackground(props);
  };

  if (typeof afterInitialize === 'function') {
    afterInitialize({
      handleResize: handleResize,
      handleTweak: handleTweak
    });
  }

  return {
    destroy: function destroy() {
      renderer.destroy();
    }
  };
}

exports.default = VideoBackground;
module.exports = exports['default'];